import{x as T,r as u,m as V,a,g as N,j as L,w as S,F as w,o as s,H as q,b as t,L as A,f as M,t as d,n as Q,i as f,h as C}from"./app.80a9936a.js";import{_ as B}from"./AuthenticatedLayout.38a342ca.js";import{a as O}from"./index.7ebefe55.js";import{_ as F}from"./_plugin-vue_export-helper.cdc0426e.js";const H={class:"flex justify-between items-center"},z={class:"flex items-center gap-4"},E={class:"font-semibold text-xl dark:text-gray-200 text-gray-800"},I={class:"flex gap-2"},J=["disabled"],R={key:0},G={key:1},K={class:"py-6"},P={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},U={class:"mb-6 bg-white dark:bg-gray-800 shadow-sm rounded-lg p-6"},W={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},X={class:"text-lg font-semibold dark:text-gray-200"},Y={class:"text-lg font-semibold dark:text-gray-200"},Z={class:"text-lg font-semibold dark:text-gray-200"},tt={class:"text-lg font-semibold dark:text-gray-200"},et={key:0,class:"mb-6 bg-red-50 dark:bg-red-900 border-l-4 border-red-500 p-4 rounded"},at={class:"text-red-800 dark:text-red-200"},st={key:1,class:"bg-white dark:bg-gray-800 shadow-sm rounded-lg overflow-hidden"},rt={key:0,class:"overflow-x-auto"},ot={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},lt={class:"bg-gray-50 dark:bg-gray-700 sticky top-0"},dt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},nt={key:0},it=["colspan"],ct={key:1,class:"p-8 text-center text-gray-500 dark:text-gray-400"},gt={class:"text-xs mt-2"},ut={key:2,class:"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-between items-center border-t border-gray-200 dark:border-gray-600"},yt={class:"text-sm text-gray-700 dark:text-gray-300"},bt={class:"flex gap-2"},xt=["disabled"],vt=["disabled"],mt={key:2,class:"bg-white dark:bg-gray-800 shadow-sm rounded-lg p-8 text-center"},pt={__name:"TableDetails",props:{tableName:{type:String,required:!0},connection:{type:String,default:"auto"}},setup(c){const k=c,$=T(),y=u([]),_=u([]),b=u(0),x=u(50),g=u(0),n=u(!1),m=u(null),D=o=>o==null?"-":typeof o=="boolean"?o?"\u2713":"\u2717":typeof o=="object"?JSON.stringify(o):typeof o=="string"&&o.length>100?o.substring(0,100)+"...":String(o),h=async(o=0)=>{var e,v;n.value=!0,m.value=null;try{const l={limit:x.value,offset:o};k.connection&&k.connection!=="auto"&&(l.force_connection=k.connection);const r=await O.get(`/api/sync-monitor/table/${k.tableName}`,{params:l,withCredentials:!0});let i=[];Array.isArray(r.data.columns)?i=r.data.columns:r.data.columns&&typeof r.data.columns=="object"&&(i=Object.values(r.data.columns));let p=[];if(Array.isArray(r.data.data)?p=r.data.data:r.data.data&&typeof r.data.data=="object"&&(p=Object.values(r.data.data)),i.length===0&&p.length>0){const j=p[0];j&&typeof j=="object"&&(i=Object.keys(j))}y.value=i,_.value=p,b.value=r.data.total||0,g.value=r.data.offset||o}catch(l){console.error("\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062C\u062F\u0648\u0644:",l),m.value=((v=(e=l.response)==null?void 0:e.data)==null?void 0:v.error)||l.message||"\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A",$.error("\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062C\u062F\u0648\u0644")}finally{n.value=!1}};return V(()=>{h(0)}),(o,e)=>(s(),a(w,null,[N(L(q),{title:`\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062C\u062F\u0648\u0644: ${c.tableName}`},null,8,["title"]),N(B,null,{header:S(()=>[t("div",H,[t("div",z,[N(L(A),{href:"/sync-monitor",class:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 inline-block"},{default:S(()=>[...e[3]||(e[3]=[M(" \u2190 \u0631\u062C\u0648\u0639 ",-1)])]),_:1}),t("h2",E," \u{1F4CB} \u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062C\u062F\u0648\u0644: "+d(c.tableName),1)]),t("div",I,[t("span",{class:Q(["px-3 py-1 rounded-full text-sm font-semibold",c.connection==="sync_sqlite"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100":"bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-100"])},d(c.connection==="sync_sqlite"?"\u{1F5A5}\uFE0F SQLite \u0645\u062D\u0644\u064A":"\u2601\uFE0F MySQL \u0633\u064A\u0631\u0641\u0631"),3),t("button",{onClick:e[0]||(e[0]=v=>h(0)),class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",disabled:n.value},[n.value?(s(),a("span",G,"\u23F3 \u062C\u0627\u0631\u064A...")):(s(),a("span",R,"\u{1F504} \u062A\u062D\u062F\u064A\u062B"))],8,J)])])]),default:S(()=>{var v;return[t("div",K,[t("div",P,[t("div",U,[t("div",W,[t("div",null,[e[4]||(e[4]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"\u0627\u0633\u0645 \u0627\u0644\u062C\u062F\u0648\u0644",-1)),t("p",X,d(c.tableName),1)]),t("div",null,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0633\u062C\u0644\u0627\u062A",-1)),t("p",Y,d(((v=b.value)==null?void 0:v.toLocaleString())||0),1)]),t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"\u0639\u062F\u062F \u0627\u0644\u0623\u0639\u0645\u062F\u0629",-1)),t("p",Z,d(y.value.length),1)]),t("div",null,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"\u0627\u0644\u0627\u062A\u0635\u0627\u0644",-1)),t("p",tt,d(c.connection==="sync_sqlite"?"SQLite":"MySQL"),1)])])]),m.value?(s(),a("div",et,[t("p",at,d(m.value),1)])):f("",!0),!n.value&&!m.value?(s(),a("div",st,[y.value.length>0?(s(),a("div",rt,[t("table",ot,[t("thead",lt,[t("tr",null,[(s(!0),a(w,null,C(y.value,l=>(s(),a("th",{key:l,class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase border-r border-gray-200 dark:border-gray-600"},d(l),1))),128))])]),t("tbody",dt,[_.value.length===0?(s(),a("tr",nt,[t("td",{colspan:y.value.length||1,class:"px-4 py-8 text-center text-gray-500 dark:text-gray-400"}," \u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A ",8,it)])):f("",!0),(s(!0),a(w,null,C(_.value,(l,r)=>(s(),a("tr",{key:r,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[(s(!0),a(w,null,C(y.value,i=>(s(),a("td",{key:`${r}-${i}`,class:"px-4 py-3 text-sm dark:text-gray-300 border-r border-gray-100 dark:border-gray-700 whitespace-nowrap"},d(D(l[i])),1))),128))]))),128))])])])):(s(),a("div",ct,[e[8]||(e[8]=t("div",{class:"text-5xl mb-2"},"\u{1F4CB}",-1)),e[9]||(e[9]=t("p",null,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0623\u0639\u0645\u062F\u0629 \u0645\u062A\u0627\u062D\u0629 \u0644\u0644\u0639\u0631\u0636",-1)),t("p",gt,"\u0639\u062F\u062F \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A: "+d(_.value.length),1)])),b.value>x.value?(s(),a("div",ut,[t("div",yt," \u0639\u0631\u0636 "+d(g.value+1)+" \u0625\u0644\u0649 "+d(Math.min(g.value+x.value,b.value))+" \u0645\u0646 "+d(b.value),1),t("div",bt,[t("button",{onClick:e[1]||(e[1]=l=>h(g.value-x.value)),disabled:g.value===0||n.value,class:"px-4 py-2 border rounded disabled:opacity-50 dark:text-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600"}," \u2190 \u0627\u0644\u0633\u0627\u0628\u0642 ",8,xt),t("button",{onClick:e[2]||(e[2]=l=>h(g.value+x.value)),disabled:g.value+x.value>=b.value||n.value,class:"px-4 py-2 border rounded disabled:opacity-50 dark:text-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600"}," \u0627\u0644\u062A\u0627\u0644\u064A \u2192 ",8,vt)])])):f("",!0)])):f("",!0),n.value?(s(),a("div",mt,[...e[10]||(e[10]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1),t("p",{class:"mt-4 text-gray-600 dark:text-gray-400"},"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A...",-1)])])):f("",!0)])])]}),_:1})],64))}},wt=F(pt,[["__scopeId","data-v-efe167cc"]]);export{wt as default};
