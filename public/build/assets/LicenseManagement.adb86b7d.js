import{x as W,r as x,u as A,m as X,a as $,g as o,j as v,w as r,F as K,o as g,H as Y,b as e,t as i,f as d,h as Z,n as T,i as D,e as U,A as q,l as H,c as z,O as tt,v as et}from"./app.6be5046f.js";import{_ as st}from"./AuthenticatedLayout.9afd998f.js";import{M as F}from"./Modal.b6978af4.js";import{_ as m}from"./PrimaryButton.294ebcb6.js";import{_ as y}from"./InputLabel.4a689131.js";import{_ as h}from"./TextInput.973b06aa.js";import{_ as at}from"./InputError.ffa00429.js";import{a as f}from"./index.678c417c.js";/* empty css                                              */const lt={class:"py-12"},ot={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},rt={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},it={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg p-4"},dt={class:"text-2xl font-bold text-gray-900 dark:text-white"},nt={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg p-4"},ut={class:"text-2xl font-bold text-green-600"},vt={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg p-4"},pt={class:"text-2xl font-bold text-gray-600"},xt={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg p-4"},mt={class:"text-2xl font-bold text-red-600"},yt={class:"mb-6 flex justify-between items-center"},gt={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},ft={class:"p-6"},ct={class:"overflow-x-auto"},bt={class:"w-full"},wt={class:"divide-y divide-gray-200 dark:divide-gray-700"},kt={class:"px-4 py-3 text-sm text-gray-900 dark:text-white"},_t={class:"text-xs"},Ct={class:"px-4 py-3 text-sm text-gray-900 dark:text-white"},$t={class:"px-4 py-3 text-sm"},ht={class:"px-4 py-3 text-sm text-gray-900 dark:text-white"},Vt={class:"px-4 py-3 text-sm text-gray-900 dark:text-white"},Mt={class:"px-4 py-3 text-sm"},Lt={class:"flex gap-2"},Dt=["onClick"],Ut=["onClick"],Ft=["onClick","title"],jt=["onClick"],St={key:0},Tt={class:"flex justify-end gap-2"},Bt={class:"flex items-center"},Et={class:"flex justify-end gap-2"},Nt={class:"space-y-3"},At={class:"text-xs"},Kt={key:0},qt={class:"flex justify-end"},Ht={class:"space-y-4"},zt={class:"mt-2 flex gap-2"},Ot={class:"flex justify-end"},te={__name:"LicenseManagement",props:{licenses:Array},setup(O){const n=W(),j=x(O.licenses||[]),p=x(!1),c=x(!1),b=x(!1),V=x(!1),M=x(!1),L=x(""),l=x(null),w=x({total:0,active:0,inactive:0,expired:0,trial:0,standard:0,premium:0}),u=A({domain:"",type:"standard",expires_at:"",max_installations:1}),k=A({type:"standard",expires_at:"",is_active:!0,notes:""}),B=a=>({trial:"\u062A\u062C\u0631\u064A\u0628\u064A",standard:"\u0642\u064A\u0627\u0633\u064A",premium:"\u0645\u0645\u064A\u0632"})[a]||a,E=a=>a.is_active?a.expires_at&&new Date(a.expires_at)<new Date?"bg-red-500":a.days_remaining!==null&&a.days_remaining<30?"bg-yellow-500":"bg-green-500":"bg-gray-500",_=async()=>{try{const a=await f.get("/api/admin/licenses/statistics");a.data.success&&(w.value=a.data.statistics)}catch(a){console.error("Failed to load statistics:",a)}},C=async()=>{p.value=!0;try{const a=await f.get("/api/admin/licenses");a.data.success&&(j.value=a.data.licenses.map(t=>({...t,activated_at:t.activated_at,expires_at:t.expires_at,days_remaining:t.days_remaining})))}catch{n.error("\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062A\u0631\u062E\u064A\u0635\u0627\u062A")}finally{p.value=!1}},G=async()=>{var a,t;p.value=!0;try{const s=await f.post("/api/admin/licenses",u.data());s.data.success&&(n.success("\u062A\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062A\u0631\u062E\u064A\u0635 \u0628\u0646\u062C\u0627\u062D!"),L.value=s.data.license_key,c.value=!1,M.value=!0,u.reset(),await C(),await _())}catch(s){n.error(((t=(a=s.response)==null?void 0:a.data)==null?void 0:t.message)||"\u0641\u0634\u0644 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062A\u0631\u062E\u064A\u0635")}finally{p.value=!1}},I=async()=>{try{await navigator.clipboard.writeText(L.value),n.success("\u062A\u0645 \u0646\u0633\u062E \u0645\u0641\u062A\u0627\u062D \u0627\u0644\u062A\u0631\u062E\u064A\u0635!")}catch{const t=document.createElement("textarea");t.value=L.value,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),n.success("\u062A\u0645 \u0646\u0633\u062E \u0645\u0641\u062A\u0627\u062D \u0627\u0644\u062A\u0631\u062E\u064A\u0635!")}},J=async a=>{try{const t=await f.post(`/api/admin/licenses/${a}/toggle`);t.data.success&&(n.success(t.data.message),await C(),await _())}catch{n.error("\u0641\u0634\u0644 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062A\u0631\u062E\u064A\u0635")}},P=async a=>{if(!!confirm("\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 \u0647\u0630\u0627 \u0627\u0644\u062A\u0631\u062E\u064A\u0635\u061F"))try{(await f.delete(`/api/admin/licenses/${a}`)).data.success&&(n.success("\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u062A\u0631\u062E\u064A\u0635 \u0628\u0646\u062C\u0627\u062D"),await C(),await _())}catch{n.error("\u0641\u0634\u0644 \u062D\u0630\u0641 \u0627\u0644\u062A\u0631\u062E\u064A\u0635")}},N=async a=>{try{const t=await f.get(`/api/admin/licenses/${a}`);t.data.success&&(l.value=t.data.license,V.value=!0)}catch{n.error("\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644")}},Q=async()=>{var a,t;if(!!l.value){p.value=!0,k.type=l.value.type,k.expires_at=l.value.expires_at,k.is_active=l.value.is_active,k.notes=l.value.notes||"";try{(await f.put(`/api/admin/licenses/${l.value.id}`,k.data())).data.success&&(n.success("\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062A\u0631\u062E\u064A\u0635 \u0628\u0646\u062C\u0627\u062D"),b.value=!1,await C(),await _())}catch(s){n.error(((t=(a=s.response)==null?void 0:a.data)==null?void 0:t.message)||"\u0641\u0634\u0644 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062A\u0631\u062E\u064A\u0635")}finally{p.value=!1}}},R=async a=>{await N(a),b.value=!0};return X(()=>{_()}),(a,t)=>(g(),$(K,null,[o(v(Y),{title:"\u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u062A\u0631\u062E\u064A\u0635\u0627\u062A"}),o(st,null,{header:r(()=>[...t[19]||(t[19]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight dark:text-gray-200"}," \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u062A\u0631\u062E\u064A\u0635\u0627\u062A ",-1)])]),default:r(()=>[e("div",lt,[e("div",ot,[e("div",rt,[e("div",it,[t[20]||(t[20]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u062A\u0631\u062E\u064A\u0635\u0627\u062A",-1)),e("div",dt,i(w.value.total),1)]),e("div",nt,[t[21]||(t[21]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"\u0645\u0641\u0639\u0644",-1)),e("div",ut,i(w.value.active),1)]),e("div",vt,[t[22]||(t[22]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"\u0645\u0639\u0637\u0644",-1)),e("div",pt,i(w.value.inactive),1)]),e("div",xt,[t[23]||(t[23]=e("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"\u0645\u0646\u062A\u0647\u064A",-1)),e("div",mt,i(w.value.expired),1)])]),e("div",yt,[o(m,{onClick:t[0]||(t[0]=s=>c.value=!0)},{default:r(()=>[...t[24]||(t[24]=[d(" \u2795 \u0625\u0646\u0634\u0627\u0621 \u062A\u0631\u062E\u064A\u0635 \u062C\u062F\u064A\u062F ",-1)])]),_:1}),o(m,{onClick:C,disabled:p.value},{default:r(()=>[...t[25]||(t[25]=[d(" \u{1F504} \u062A\u062D\u062F\u064A\u062B ",-1)])]),_:1},8,["disabled"])]),e("div",gt,[e("div",ft,[e("div",ct,[e("table",bt,[t[27]||(t[27]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Domain"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"\u0627\u0644\u0646\u0648\u0639"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"\u0627\u0644\u062D\u0627\u0644\u0629"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"\u064A\u0646\u062A\u0647\u064A \u0641\u064A"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"\u0645\u0641\u0639\u0644 \u0645\u0646\u0630"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A")])],-1)),e("tbody",wt,[(g(!0),$(K,null,Z(j.value,s=>(g(),$("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",kt,[e("code",_t,i(s.domain),1)]),e("td",Ct,i(B(s.type)),1),e("td",$t,[e("span",{class:T([["px-2 py-1 rounded text-xs",E(s)],"text-white"])},i(s.is_active?"\u0645\u0641\u0639\u0644":"\u0645\u0639\u0637\u0644"),3)]),e("td",ht,i(s.expires_at||"\u062F\u0627\u0626\u0645"),1),e("td",Vt,i(s.activated_at||"-"),1),e("td",Mt,[e("div",Lt,[e("button",{onClick:S=>N(s.id),class:"text-blue-600 hover:text-blue-800",title:"\u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644"}," \u{1F441}\uFE0F ",8,Dt),e("button",{onClick:S=>R(s.id),class:"text-yellow-600 hover:text-yellow-800",title:"\u062A\u0639\u062F\u064A\u0644"}," \u270F\uFE0F ",8,Ut),e("button",{onClick:S=>J(s.id),class:T(s.is_active?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800"),title:s.is_active?"\u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u062A\u0641\u0639\u064A\u0644":"\u062A\u0641\u0639\u064A\u0644"},i(s.is_active?"\u23F8\uFE0F":"\u25B6\uFE0F"),11,Ft),e("button",{onClick:S=>P(s.id),class:"text-red-600 hover:text-red-800",title:"\u062D\u0630\u0641"}," \u{1F5D1}\uFE0F ",8,jt)])])]))),128)),j.value.length===0?(g(),$("tr",St,[...t[26]||(t[26]=[e("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500 dark:text-gray-400"}," \u0644\u0627 \u062A\u0648\u062C\u062F \u062A\u0631\u0627\u062E\u064A\u0635 ",-1)])])):D("",!0)])])])])])])]),o(F,{show:c.value,onClose:t[7]||(t[7]=s=>c.value=!1)},{header:r(()=>[...t[28]||(t[28]=[e("h3",{class:"text-lg font-semibold"},"\u0625\u0646\u0634\u0627\u0621 \u062A\u0631\u062E\u064A\u0635 \u062C\u062F\u064A\u062F",-1)])]),body:r(()=>[e("form",{onSubmit:t[5]||(t[5]=H(()=>{},["prevent"])),class:"space-y-4"},[e("div",null,[o(y,{for:"domain",value:"Domain"}),o(h,{id:"domain",modelValue:v(u).domain,"onUpdate:modelValue":t[1]||(t[1]=s=>v(u).domain=s),type:"text",class:"mt-1 block w-full",placeholder:"example.com",required:""},null,8,["modelValue"]),o(at,{message:v(u).errors.domain},null,8,["message"])]),e("div",null,[o(y,{for:"type",value:"\u0627\u0644\u0646\u0648\u0639"}),U(e("select",{id:"type","onUpdate:modelValue":t[2]||(t[2]=s=>v(u).type=s),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300",required:""},[...t[29]||(t[29]=[e("option",{value:"trial"},"\u062A\u062C\u0631\u064A\u0628\u064A",-1),e("option",{value:"standard"},"\u0642\u064A\u0627\u0633\u064A",-1),e("option",{value:"premium"},"\u0645\u0645\u064A\u0632",-1)])],512),[[q,v(u).type]])]),e("div",null,[o(y,{for:"expires_at",value:"\u064A\u0646\u062A\u0647\u064A \u0641\u064A (\u0627\u062E\u062A\u064A\u0627\u0631\u064A)"}),o(h,{id:"expires_at",modelValue:v(u).expires_at,"onUpdate:modelValue":t[3]||(t[3]=s=>v(u).expires_at=s),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"])]),e("div",null,[o(y,{for:"max_installations",value:"\u0639\u062F\u062F \u0627\u0644\u062A\u062B\u0628\u064A\u062A\u0627\u062A"}),o(h,{id:"max_installations",modelValue:v(u).max_installations,"onUpdate:modelValue":t[4]||(t[4]=s=>v(u).max_installations=s),type:"number",min:"1",class:"mt-1 block w-full"},null,8,["modelValue"])])],32)]),footer:r(()=>[e("div",Tt,[o(m,{type:"button",onClick:t[6]||(t[6]=s=>c.value=!1)},{default:r(()=>[...t[30]||(t[30]=[d(" \u0625\u0644\u063A\u0627\u0621 ",-1)])]),_:1}),o(m,{type:"button",onClick:G,disabled:p.value},{default:r(()=>[...t[31]||(t[31]=[d(" \u0625\u0646\u0634\u0627\u0621 ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["show"]),l.value?(g(),z(F,{key:0,show:b.value,onClose:t[14]||(t[14]=s=>b.value=!1)},{header:r(()=>[...t[32]||(t[32]=[e("h3",{class:"text-lg font-semibold"},"\u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u062A\u0631\u062E\u064A\u0635",-1)])]),body:r(()=>[e("form",{onSubmit:t[12]||(t[12]=H(()=>{},["prevent"])),class:"space-y-4"},[e("div",null,[o(y,{for:"edit_type",value:"\u0627\u0644\u0646\u0648\u0639"}),U(e("select",{id:"edit_type","onUpdate:modelValue":t[8]||(t[8]=s=>l.value.type=s),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300"},[...t[33]||(t[33]=[e("option",{value:"trial"},"\u062A\u062C\u0631\u064A\u0628\u064A",-1),e("option",{value:"standard"},"\u0642\u064A\u0627\u0633\u064A",-1),e("option",{value:"premium"},"\u0645\u0645\u064A\u0632",-1)])],512),[[q,l.value.type]])]),e("div",null,[o(y,{for:"edit_expires_at",value:"\u064A\u0646\u062A\u0647\u064A \u0641\u064A"}),o(h,{id:"edit_expires_at",modelValue:l.value.expires_at,"onUpdate:modelValue":t[9]||(t[9]=s=>l.value.expires_at=s),type:"datetime-local",class:"mt-1 block w-full"},null,8,["modelValue"])]),e("div",null,[e("label",Bt,[U(e("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=s=>l.value.is_active=s),class:"rounded border-gray-300"},null,512),[[tt,l.value.is_active]]),t[34]||(t[34]=e("span",{class:"ml-2 text-sm text-gray-600 dark:text-gray-400"},"\u0645\u0641\u0639\u0644",-1))])]),e("div",null,[o(y,{for:"notes",value:"\u0645\u0644\u0627\u062D\u0638\u0627\u062A"}),U(e("textarea",{id:"notes","onUpdate:modelValue":t[11]||(t[11]=s=>l.value.notes=s),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300",rows:"3"},null,512),[[et,l.value.notes]])])],32)]),footer:r(()=>[e("div",Et,[o(m,{type:"button",onClick:t[13]||(t[13]=s=>b.value=!1)},{default:r(()=>[...t[35]||(t[35]=[d(" \u0625\u0644\u063A\u0627\u0621 ",-1)])]),_:1}),o(m,{type:"button",onClick:Q,disabled:p.value},{default:r(()=>[...t[36]||(t[36]=[d(" \u062D\u0641\u0638 ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["show"])):D("",!0),l.value?(g(),z(F,{key:1,show:V.value,onClose:t[16]||(t[16]=s=>V.value=!1)},{header:r(()=>[...t[37]||(t[37]=[e("h3",{class:"text-lg font-semibold"},"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062A\u0631\u062E\u064A\u0635",-1)])]),body:r(()=>{var s;return[e("div",Nt,[e("div",null,[t[38]||(t[38]=e("strong",null,"Domain:",-1)),d(" "+i(l.value.domain),1)]),e("div",null,[t[39]||(t[39]=e("strong",null,"Fingerprint:",-1)),e("code",At,i(l.value.fingerprint),1)]),e("div",null,[t[40]||(t[40]=e("strong",null,"\u0627\u0644\u0646\u0648\u0639:",-1)),d(" "+i(B(l.value.type)),1)]),e("div",null,[t[41]||(t[41]=e("strong",null,"\u0627\u0644\u062D\u0627\u0644\u0629:",-1)),e("span",{class:T([["px-2 py-1 rounded text-xs",E(l.value)],"text-white"])},i(l.value.is_active?"\u0645\u0641\u0639\u0644":"\u0645\u0639\u0637\u0644"),3)]),e("div",null,[t[42]||(t[42]=e("strong",null,"\u064A\u0646\u062A\u0647\u064A \u0641\u064A:",-1)),d(" "+i(l.value.expires_at||"\u062F\u0627\u0626\u0645"),1)]),e("div",null,[t[43]||(t[43]=e("strong",null,"\u0627\u0644\u0623\u064A\u0627\u0645 \u0627\u0644\u0645\u062A\u0628\u0642\u064A\u0629:",-1)),d(" "+i((s=l.value.days_remaining)!=null?s:"\u221E"),1)]),e("div",null,[t[44]||(t[44]=e("strong",null,"\u0645\u0641\u0639\u0644 \u0645\u0646\u0630:",-1)),d(" "+i(l.value.activated_at||"-"),1)]),e("div",null,[t[45]||(t[45]=e("strong",null,"\u0622\u062E\u0631 \u062A\u062D\u0642\u0642:",-1)),d(" "+i(l.value.last_verified_at||"-"),1)]),l.value.max_installations?(g(),$("div",Kt,[t[46]||(t[46]=e("strong",null,"\u0639\u062F\u062F \u0627\u0644\u062A\u062B\u0628\u064A\u062A\u0627\u062A \u0627\u0644\u0645\u0633\u0645\u0648\u062D:",-1)),d(" "+i(l.value.max_installations),1)])):D("",!0)])]}),footer:r(()=>[e("div",qt,[o(m,{onClick:t[15]||(t[15]=s=>V.value=!1)},{default:r(()=>[...t[47]||(t[47]=[d(" \u0625\u063A\u0644\u0627\u0642 ",-1)])]),_:1})])]),_:1},8,["show"])):D("",!0),o(F,{show:M.value,onClose:t[18]||(t[18]=s=>M.value=!1)},{header:r(()=>[...t[48]||(t[48]=[e("h3",{class:"text-lg font-semibold"},"\u0645\u0641\u062A\u0627\u062D \u0627\u0644\u062A\u0631\u062E\u064A\u0635",-1)])]),body:r(()=>[e("div",Ht,[e("div",null,[o(y,{value:"\u0627\u0646\u0633\u062E \u0647\u0630\u0627 \u0627\u0644\u0645\u0641\u062A\u0627\u062D \u0648\u0627\u062D\u0641\u0638\u0647 \u0641\u064A \u0645\u0643\u0627\u0646 \u0622\u0645\u0646"}),e("div",zt,[o(h,{value:L.value,type:"text",readonly:"",class:"flex-1 font-mono text-sm"},null,8,["value"]),o(m,{onClick:I,type:"button"},{default:r(()=>[...t[49]||(t[49]=[d(" \u{1F4CB} \u0646\u0633\u062E ",-1)])]),_:1})]),t[50]||(t[50]=e("p",{class:"mt-2 text-sm text-gray-600 dark:text-gray-400"}," \u26A0\uFE0F \u0644\u0646 \u062A\u062A\u0645\u0643\u0646 \u0645\u0646 \u0631\u0624\u064A\u0629 \u0647\u0630\u0627 \u0627\u0644\u0645\u0641\u062A\u0627\u062D \u0645\u0631\u0629 \u0623\u062E\u0631\u0649 \u0628\u0639\u062F \u0625\u063A\u0644\u0627\u0642 \u0647\u0630\u0647 \u0627\u0644\u0646\u0627\u0641\u0630\u0629 ",-1))])])]),footer:r(()=>[e("div",Ot,[o(m,{onClick:t[17]||(t[17]=s=>M.value=!1)},{default:r(()=>[...t[51]||(t[51]=[d(" \u062A\u0645 ",-1)])]),_:1})])]),_:1},8,["show"])]),_:1})],64))}};export{te as default};
