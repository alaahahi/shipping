# ุฅุตูุงุญ ูุดููุฉ ุชูุฑุงุฑ ุงูุทูุจุงุช ูู Service Worker

## ๐ด ุงููุดููุฉ:

ุนูุฏ ุนุฏู ูุฌูุฏ ุงุชุตุงู ุจุงูุฅูุชุฑูุชุ ูุงูุช ุงูุทูุจุงุช ุชุชูุฑุฑ ุนุฏุฉ ูุฑุงุช:

```
โ accounting (failed) ERR_INTERNET_DISCONNECTED - ูุฑุฉ 1
โ accounting (failed) ERR_INTERNET_DISCONNECTED - ูุฑุฉ 2  
โ accounting (failed) ERR_INTERNET_DISCONNECTED - ูุฑุฉ 3
โ stylesheets (failed) ERR_INTERNET_DISCONNECTED - ูุฑุฉ 1
โ stylesheets (failed) ERR_INTERNET_DISCONNECTED - ูุฑุฉ 2
โ stylesheets (failed) ERR_INTERNET_DISCONNECTED - ูุฑุฉ 3
โ stylesheets (failed) ERR_INTERNET_DISCONNECTED - ูุฑุฉ 4
```

### ุฃุณุจุงุจ ุงููุดููุฉ:

1. **ูุง ููุฌุฏ timeout ููุทูุจุงุช**: `fetch()` ูุงู ูุญุงูู ุงูุงุชุตุงู ุจุฏูู ุญุฏ ุฒููู
2. **ูุง ููุฌุฏ ุญูุงูุฉ ูู ุงูุชูุฑุงุฑ**: ููุณ ุงูุทูุจ ููุฑุณู ุนุฏุฉ ูุฑุงุช ูู ููุช ูุงุญุฏ
3. **ุงููุชุตูุญ ูุนูุฏ ุงููุญุงููุฉ**: ุนูุฏ ูุดู ุงูุทูุจุ ุงููุชุตูุญ ุฃู ุงูููุฏ ูุญุงูู ูุฑุฉ ุฃุฎุฑู
4. **ูุง ููุฌุฏ ุฅูุบุงุก ููุทูุจุงุช**: ุงูุทูุจุงุช ุงููุนููุฉ ูุง ุชููุบู

---

## โ ุงูุญู ุงููุทุจู:

### 1. **Request Deduplication (ููุน ุงูุชูุฑุงุฑ)**

```javascript
// ุชุชุจุน ุงูุทูุจุงุช ุงูุฌุงุฑูุฉ
const pendingRequests = new Map();

async function getDedupedRequest(requestKey, fetchFn) {
    // ุฅุฐุง ูุงู ููุณ ุงูุทูุจ ููุฏ ุงูุชูููุฐุ ููุชุธุฑู ุจุฏูุงู ูู ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ
    if (pendingRequests.has(requestKey)) {
        console.log('โณ ุทูุจ ููุฑุฑ ุชู ููุนู:', requestKey);
        return pendingRequests.get(requestKey);
    }
    
    // ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ ููุท ุฅุฐุง ูู ููู ููุฌูุฏุงู
    const promise = fetchFn().finally(() => {
        pendingRequests.delete(requestKey);
    });
    
    pendingRequests.set(requestKey, promise);
    return promise;
}
```

**ุงููุงุฆุฏุฉ**: ุฅุฐุง ุชู ุทูุจ ููุณ ุงูู URL ุนุฏุฉ ูุฑุงุช ูู ููุณ ุงูููุชุ ูุชู ุชูููุฐ ุทูุจ ูุงุญุฏ ููุท.

---

### 2. **Fetch ูุน Timeout**

```javascript
const FETCH_TIMEOUT = 3000; // 3 ุซูุงู

async function fetchWithTimeout(request, timeout = FETCH_TIMEOUT) {
    const controller = new AbortController();
    const timeoutId = setTimeout(() => controller.abort(), timeout);
    
    try {
        const response = await fetch(request, {
            signal: controller.signal
        });
        clearTimeout(timeoutId);
        return response;
    } catch (error) {
        clearTimeout(timeoutId);
        
        if (error.name === 'AbortError') {
            throw new Error('Request timeout');
        }
        
        throw error;
    }
}
```

**ุงููุงุฆุฏุฉ**: 
- ุฅุฐุง ูู ูุฑุฏ ุงูุฎุงุฏู ุฎูุงู 3 ุซูุงูุ ูููุบู ุงูุทูุจ
- ูููุน ุงูุทูุจุงุช ูู ุงูุงูุชุธุงุฑ ุฅูู ุงูุฃุจุฏ
- ุงุณุชุฌุงุจุฉ ุณุฑูุนุฉ ูู ุญุงูุฉ offline

---

### 3. **ุชุทุจูู ุงูุญููู ูู ุฌููุน ุงูุทูุจุงุช**

#### ูุจู:
```javascript
const response = await fetch(request);
```

#### ุจุนุฏ:
```javascript
const response = await fetchWithTimeout(request);
```

ุชู ุงูุชุทุจูู ูู:
- โ `handleMutationRequest()` - POST, PUT, DELETE
- โ `cacheFirst()` - ุงูุฃุตูู ุงูุซุงุจุชุฉ
- โ `networkFirst()` - ุงูุตูุญุงุช ู API

---

### 4. **ุชูููู ุงูู Logs**

```javascript
// ูุจู: ุงููุซูุฑ ูู console.log
console.log('๐ฆ ูู ุงูู Cache:', request.url);

// ุจุนุฏ: ููุท ุนูุฏ ุงูุญุงุฌุฉ
// console.log('๐ฆ ูู ุงูู Cache:', request.url);
```

**ุงููุงุฆุฏุฉ**: Console ูุธูู ูุณูู ุงููุฑุงุกุฉ

---

## ๐ ุงูููุงุฑูุฉ:

### ูุจู ุงูุฅุตูุงุญ:
```
โ accounting - ูุญุงููุฉ 1 (5 ุซูุงู ุงูุชุธุงุฑ)
โ accounting - ูุญุงููุฉ 2 (5 ุซูุงู ุงูุชุธุงุฑ)
โ accounting - ูุญุงููุฉ 3 (5 ุซูุงู ุงูุชุธุงุฑ)
โ stylesheets - ูุญุงููุฉ 1 (5 ุซูุงู ุงูุชุธุงุฑ)
โ stylesheets - ูุญุงููุฉ 2 (5 ุซูุงู ุงูุชุธุงุฑ)
...
โฑ๏ธ ุฅุฌูุงูู ุงูููุช: 30+ ุซุงููุฉ
๐ ุนุฏุฏ ุงูุทูุจุงุช: 15+ ุทูุจ
```

### ุจุนุฏ ุงูุฅุตูุงุญ:
```
โ accounting - ูุญุงููุฉ ูุงุญุฏุฉ (3 ุซูุงู timeout) โ
โ stylesheets - ูุญุงููุฉ ูุงุญุฏุฉ (3 ุซูุงู timeout) โ
โ javascript - ูุญุงููุฉ ูุงุญุฏุฉ (3 ุซูุงู timeout) โ
...
โฑ๏ธ ุฅุฌูุงูู ุงูููุช: 3-4 ุซูุงู
๐ ุนุฏุฏ ุงูุทูุจุงุช: 3 ุทูุจุงุช ููุท
```

**ุชุญุณู**: 
- โก **ุฃุณุฑุน 7-8 ูุฑุงุช**
- ๐ **80% ุฃูู ูู ุนุฏุฏ ุงูุทูุจุงุช**
- ๐พ **ุฃูู ุงุณุชููุงูุงู ููููุงุฑุฏ**

---

## ๐ง ุงูุชุบููุฑุงุช ุงูุชูููุฉ:

### ูู `public/service-worker.js`:

1. **ุชุญุฏูุซ ุงูุฅุตุฏุงุฑ**:
```javascript
const CACHE_VERSION = 'v1.1.0'; // ูุญุฏุซ
```

2. **ุฅุถุงูุฉ ุซูุงุจุช ุฌุฏูุฏุฉ**:
```javascript
const FETCH_TIMEOUT = 3000;
const pendingRequests = new Map();
```

3. **ุฏูุงู ุฌุฏูุฏุฉ**:
- `getDedupedRequest()` - ููุน ุงูุชูุฑุงุฑ
- `fetchWithTimeout()` - timeout ููุทูุจุงุช

4. **ุชุญุฏูุซ ุงูุฏูุงู ุงูููุฌูุฏุฉ**:
- `handleGetRequest()` - ุชุณุชุฎุฏู deduplication
- `handleMutationRequest()` - ุชุณุชุฎุฏู timeout
- `cacheFirst()` - ุชุณุชุฎุฏู timeout
- `networkFirst()` - ุชุณุชุฎุฏู timeout

---

## ๐ ุงูุฎุทูุงุช ุงููุทููุจุฉ:

### 1. ูุณุญ Service Worker ุงููุฏูู:

ุงูุชุญ Developer Tools (F12):
```javascript
// ูู Console
navigator.serviceWorker.getRegistrations().then(registrations => {
    registrations.forEach(r => r.unregister());
    location.reload();
});
```

ุฃู:

```
1. ุงุฐูุจ ูู Application tab
2. ุงุถุบุท ุนูู Service Workers
3. ุงุถุบุท Unregister
4. ุงุนูู Hard Reload (Ctrl+Shift+R)
```

### 2. ูุณุญ ุงููุงุด:

ูู Developer Tools โ Application โ Cache Storage:
```
ุงุญุฐู ุฌููุน ุงูู caches
```

### 3. ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ:

```
Ctrl+Shift+R (Hard Reload)
```

---

## โ ุงูุชุญูู ูู ุงููุฌุงุญ:

### 1. ุงูุชุญ Network Tab ูู Developer Tools

### 2. ุงูุนูู Offline Mode:
```
Network โ Throttling โ Offline
```

### 3. ุฌุฑุจ ุงูุชููู ุจูู ุงูุตูุญุงุช

### 4. ุฑุงูุจ ุนุฏุฏ ุงูุทูุจุงุช:

**ูุฌุจ ุฃู ุชุฑู**:
- โ ูู ุทูุจ ูุธูุฑ ูุฑุฉ ูุงุญุฏุฉ ููุท
- โ ุงูุทูุจุงุช ุชูุดู ุจุณุฑุนุฉ (3 ุซูุงู max)
- โ ูุง ููุฌุฏ ุชูุฑุงุฑ
- โ Console ูุธูู

**ูุง ูุฌุจ ุฃู ุชุฑู**:
- โ ููุณ ุงูุทูุจ ูุชูุฑุฑ ุนุฏุฉ ูุฑุงุช
- โ ุงูุชุธุงุฑ ุทููู (ุฃูุซุฑ ูู 3 ุซูุงู)
- โ ุงููุซูุฑ ูู ุงูุฃุฎุทุงุก ุงููุชูุฑุฑุฉ

---

## ๐ ุงูููุงุฆุฏ:

### 1. **ุฃุฏุงุก ุฃูุถู**:
- โก ุงุณุชุฌุงุจุฉ ุฃุณุฑุน ุนูุฏ offline
- ๐ ุงุณุชููุงู ุฃูู ููุจุทุงุฑูุฉ
- ๐พ ุงุณุชููุงู ุฃูู ููุฐุงูุฑุฉ

### 2. **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู**:
- ๐ ุชุญููู ุฃุณุฑุน
- ๐ ูุง ูุฒูุฏ ูู ุงูุชุฃุฎูุฑุงุช
- ๐ฑ ูุนูู ุจุณูุงุณุฉ ุนูู ุงูููุจุงูู

### 3. **ููุฏ ุฃูุถู**:
- ๐งน ููุทู ูุงุถุญ ูููุธู
- ๐ ุญูุงูุฉ ูู ุงูุชูุฑุงุฑ
- ๐ ุณูููุฉ ุงูุชุชุจุน ูุงูุชุตุญูุญ

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก:

### ุงููุดููุฉ: ูุง ูุฒุงู ููุงู ุชูุฑุงุฑ

**ุงูุญู**:
1. ุงูุณุญ Service Worker ุงููุฏูู ุชูุงูุงู
2. ุงูุณุญ ุฌููุน ุงูู caches
3. ุฃุบูู ุฌููุน ุชุจููุจุงุช ุงููููุน
4. ุงูุชุญ ุชุจููุจ ุฌุฏูุฏ

### ุงููุดููุฉ: Offline mode ูุง ูุนูู

**ุงูุญู**:
1. ุชุฃูุฏ ูู ุชุณุฌูู Service Worker:
```javascript
navigator.serviceWorker.ready.then(() => console.log('SW Ready'));
```
2. ุชุญูู ูู Console ููุฃุฎุทุงุก
3. ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู HTTPS ุฃู localhost

### ุงููุดููุฉ: ุงูุทูุจุงุช ุจุทูุฆุฉ

**ุงูุญู**:
1. ููู `FETCH_TIMEOUT` ุฅูู ุซุงููุชูู
2. ุชุฃูุฏ ูู ุฃู ุงูู cache ูุนูู ุจุดูู ุตุญูุญ

---

## ๐ ุงูููุฎุต:

โ **ุชู ุฅุตูุงุญ**: ุชูุฑุงุฑ ุงูุทูุจุงุช ุนูุฏ offline
โ **ุชู ุฅุถุงูุฉ**: timeout ููุทูุจุงุช (3 ุซูุงู)
โ **ุชู ุฅุถุงูุฉ**: ุญูุงูุฉ ูู ุงูุชูุฑุงุฑ (deduplication)
โ **ุชู ุชุญุณูู**: ุงูุฃุฏุงุก ูุงูุณุฑุนุฉ
โ **ุชู ุชุญุณูู**: ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู

๐ฏ **ุงููุชูุฌุฉ**: ูุธุงู offline ุณุฑูุน ูููุซูู ุจุฏูู ุชูุฑุงุฑ ูู ุงูุทูุจุงุช!

