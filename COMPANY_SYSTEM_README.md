# ๐ข ูุธุงู ุญุณุงุจุงุช ุงูุดุฑูุงุช - ุงูุชุฎููุต ูุงูููู ุงูุฏุงุฎูู

## ๐ ุฌุฏูู ุงููุญุชููุงุช
1. [ูุธุฑุฉ ุนุงูุฉ](#ูุธุฑุฉ-ุนุงูุฉ)
2. [ุงูููุฒุงุช](#ุงูููุฒุงุช)
3. [ุงูุจููุฉ ุงูุชูููุฉ](#ุงูุจููุฉ-ุงูุชูููุฉ)
4. [ุงูุชุซุจูุช](#ุงูุชุซุจูุช)
5. [ุงูุงุณุชุฎุฏุงู](#ุงูุงุณุชุฎุฏุงู)
6. [ุงูุญุณุงุจุงุช](#ุงูุญุณุงุจุงุช)
7. [API Documentation](#api-documentation)
8. [ุงูุงุฎุชุจุงุฑ](#ุงูุงุฎุชุจุงุฑ)
9. [ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ](#ุงูุฃุณุฆูุฉ-ุงูุดุงุฆุนุฉ)

---

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ูุชูุงูู ูุฅุฏุงุฑุฉ ุญุณุงุจุงุช ุดุฑูุงุช ุงูุดุญู ุงูุจุญุฑูุ ูุชุถูู:
- **ุงูุชุฎููุต ุงูุฌูุฑูู**: ุฑุณูู ุซุงุจุชุฉ ููู ุณูุงุฑุฉ (ุงูุชุฑุงุถู: 40 ุฏููุงุฑ)
- **ุงูููู ุงูุฏุงุฎูู**: ูุจูุบ ููู ูููุฒุน ุชููุงุฆูุงู ุนูู ุงูุณูุงุฑุงุช
- **ุญุณุงุจุงุช ุชููุงุฆูุฉ**: ุฌููุน ุงูุญุณุงุจุงุช ุชุชู ุจุดูู ููุฑู
- **ูุงุฌูุฉ ุญุฏูุซุฉ**: ุชุตููู ูุชุฌุงูุจ ูุณูู ุงูุงุณุชุฎุฏุงู

---

## โจ ุงูููุฒุงุช

### 1. **ูุงุฆูุฉ ุงูุดุฑูุงุช**
- โ ุนุฑุถ ุฌููุน ุงูุดุฑูุงุช
- โ ุจุญุซ ุจุงูุงุณู ุฃู ุงููุงุชู
- โ ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ (ุนุฏุฏ ุงูุดุญูุงุชุ ุงูุณูุงุฑุงุชุ ุงูุฅุฌูุงูู)
- โ ุจุทุงูุงุช ุชูุงุนููุฉ

### 2. **ุชูุงุตูู ุงูุดุฑูุฉ**
- โ ูุนูููุงุช ุงูุดุฑูุฉ ุงููุงููุฉ
- โ ุฌููุน ุงูุดุญูุงุช ูุน ุงูุชูุงุตูู
- โ ุชุนุฏูู ุงูุฑุณูู ููู ุดุญูุฉ
- โ ุนุฑุถ ุงูุณูุงุฑุงุช ููู ุดุญูุฉ
- โ ุฅุญุตุงุฆูุงุช ุดุงููุฉ

### 3. **ุงูุชุฎููุต ุงูุฌูุฑูู**
- โ ุฑุณูู ุซุงุจุชุฉ ููู ุณูุงุฑุฉ
- โ ูุงุจู ููุชุนุฏูู ููู ุดุญูุฉ
- โ ุญุณุงุจ ุชููุงุฆู ููุฅุฌูุงูู
- โ ุงูุชุฑุงุถู: 40 ุฏููุงุฑ

### 4. **ุงูููู ุงูุฏุงุฎูู**
- โ ุฅุฏุฎุงู ุงููุจูุบ ุงูููู
- โ ุชูุฒูุน ุชููุงุฆู ุนูู ุงูุณูุงุฑุงุช
- โ ุนุฑุถ ุงูุชูููุฉ ููู ุณูุงุฑุฉ
- โ ูุฑููุฉ ูู ุงูุชุนุฏูู

---

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ

### **Backend (Laravel)**
```
app/
โโโ Http/Controllers/
โ   โโโ CompanyBalanceController.php
โโโ Models/
โ   โโโ TripCompany.php (updated)
โ   โโโ User.php
โโโ Services/
    โโโ AccountingCacheService.php
```

### **Frontend (Vue.js + Inertia.js)**
```
resources/js/Pages/CompanyBalances/
โโโ Index.vue (ูุงุฆูุฉ ุงูุดุฑูุงุช)
โโโ Show.vue (ุชูุงุตูู ุงูุดุฑูุฉ)
```

### **Database**
```
trip_companies:
โโโ clearance_per_car (DECIMAL 10,2)
โโโ internal_transport_total (DECIMAL 10,2)
```

### **Routes**
```php
// Web Routes
GET  /company-balances
GET  /company-balances/{companyId}

// API Routes
PUT  /api/company-shipments/{shipmentId}/fees
```

---

## ๐ ุงูุชุซุจูุช

### **ุงูุฎุทูุฉ 1: ูุงุนุฏุฉ ุงูุจูุงูุงุช**

#### **ุนูู ุงูุณูุฑูุฑ:**
```bash
mysql -u root -p your_database < sql_company_clearance_transport.sql
```

#### **ูุญููุงู:**
```bash
php artisan migrate
```

### **ุงูุฎุทูุฉ 2: ุงูุชุญูู**
```sql
-- ุชุญูู ูู ุงูุญููู ุงูุฌุฏูุฏุฉ
DESCRIBE trip_companies;

-- ูุฌุจ ุฃู ุชุฑู:
-- clearance_per_car
-- internal_transport_total
```

### **ุงูุฎุทูุฉ 3: ุงุฎุชุจุงุฑ**
```bash
# ุงูุชุญ ูู ุงููุชุตูุญ:
http://your-domain.com/test-company.html
```

---

## ๐ ุงูุงุณุชุฎุฏุงู

### **1. ุงููุตูู ูููุธุงู**

#### **ูู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ:**
```
Dashboard โ ุญุณุงุจุงุช ุงูุดุฑูุงุช
```

#### **ูุจุงุดุฑุฉ:**
```
http://your-domain.com/company-balances
```

### **2. ุนุฑุถ ูุงุฆูุฉ ุงูุดุฑูุงุช**

```vue
<!-- ูุนุฑุถ ุฌููุน ุงูุดุฑูุงุช ูุน: -->
- ุงุณู ุงูุดุฑูุฉ
- ุฑูู ุงููุงุชู
- ุนุฏุฏ ุงูุดุญูุงุช
- ุนุฏุฏ ุงูุณูุงุฑุงุช ุงูููู
- ุงูุฅุฌูุงูู ุงูููู
```

### **3. ุงูุจุญุซ ุนู ุดุฑูุฉ**

```javascript
// ุงูุจุญุซ ูุนูู ุนูู:
- ุงุณู ุงูุดุฑูุฉ
- ุฑูู ุงููุงุชู
```

### **4. ุนุฑุถ ุชูุงุตูู ุงูุดุฑูุฉ**

ุงููุฑ ุนูู ุจุทุงูุฉ ุงูุดุฑูุฉ ูุนุฑุถ:
- ุฌููุน ุงูุดุญูุงุช
- ุชูุงุตูู ูู ุดุญูุฉ
- ุงูุณูุงุฑุงุช
- ุงูุฅุญุตุงุฆูุงุช

### **5. ุชุนุฏูู ุงูุฑุณูู**

```javascript
// ููู ุดุญูุฉ:
1. ุงููุฑ "ุชุนุฏูู"
2. ุฃุฏุฎู ุงูุชุฎููุต ููู ุณูุงุฑุฉ (ูุซุงู: 40)
3. ุฃุฏุฎู ุงูููู ุงูุฏุงุฎูู ุงูููู (ูุซุงู: 1500)
4. ุงููุฑ "ุญูุธ"

// ุงููุธุงู ูุญุณุจ ุชููุงุฆูุงู:
- ุงูููู ููู ุณูุงุฑุฉ
- ุฅุฌูุงูู ุงูุชุฎููุต
- ุงูุฅุฌูุงูู ุงูููู
```

---

## ๐งฎ ุงูุญุณุงุจุงุช

### **1. ุงูุชุฎููุต ุงูุฌูุฑูู**

```javascript
ุฅุฌูุงูู ุงูุชุฎููุต = clearance_per_car ร ุนุฏุฏ ุงูุณูุงุฑุงุช

ูุซุงู:
40 ุฏููุงุฑ ร 50 ุณูุงุฑุฉ = 2,000 ุฏููุงุฑ
```

### **2. ุงูููู ุงูุฏุงุฎูู**

```javascript
ุงูููู ููู ุณูุงุฑุฉ = internal_transport_total รท ุนุฏุฏ ุงูุณูุงุฑุงุช

ูุซุงู:
1,500 ุฏููุงุฑ รท 50 ุณูุงุฑุฉ = 30 ุฏููุงุฑ/ุณูุงุฑุฉ
```

### **3. ุงูุดุญู**

```javascript
ุฅุฌูุงูู ุงูุดุญู (ุฏุฑูู) = shipping_price_aed ร ุนุฏุฏ ุงูุณูุงุฑุงุช
ุฅุฌูุงูู ุงูุดุญู (ุฏููุงุฑ) = ุฅุฌูุงูู ุงูุดุญู (ุฏุฑูู) รท ุณุนุฑ ุงูุตุฑู

ูุซุงู:
400 ุฏุฑูู ร 50 ุณูุงุฑุฉ = 20,000 ุฏุฑูู
20,000 รท 3.6725 = 5,447.47 ุฏููุงุฑ
```

### **4. ุงูุฅุฌูุงูู ุงูููุงุฆู**

```javascript
ุงูุฅุฌูุงูู = ุงูุดุญู (ุฏููุงุฑ) + ุงูุชุฎููุต + ุงูููู

ูุซุงู:
5,447.47 + 2,000 + 1,500 = 8,947.47 ุฏููุงุฑ
```

---

## ๐ก API Documentation

### **1. Get Company List**

```http
GET /company-balances
```

**Response:**
```json
{
  "companies": [
    {
      "id": 1,
      "name": "ุดุฑูุฉ ุงูููู ุงูุณุฑูุน",
      "phone": "0501234567",
      "total_cars": 150,
      "total_shipments": 3,
      "total_amount": 25000.00
    }
  ]
}
```

### **2. Get Company Details**

```http
GET /company-balances/{companyId}
```

**Response:**
```json
{
  "company": {
    "id": 1,
    "name": "ุดุฑูุฉ ุงูููู ุงูุณุฑูุน"
  },
  "shipments": [
    {
      "id": 1,
      "trip": { "ship_name": "NOOR 91", "voy_no": "001" },
      "cars_count": 50,
      "shipping_price_per_car": 109.00,
      "clearance_per_car": 40.00,
      "internal_transport_total": 1500.00,
      "internal_transport_per_car": 30.00,
      "total_amount": 8947.47
    }
  ],
  "stats": {
    "total_cars": 50,
    "total_shipments": 1,
    "total_shipping": 5447.47,
    "total_clearance": 2000.00,
    "total_transport": 1500.00,
    "grand_total": 8947.47
  }
}
```

### **3. Update Shipment Fees**

```http
PUT /api/company-shipments/{shipmentId}/fees
Content-Type: application/json

{
  "clearance_per_car": 40.00,
  "internal_transport_total": 1500.00
}
```

**Response:**
```json
{
  "success": true,
  "message": "ุชู ุชุญุฏูุซ ุงูุฑุณูู ุจูุฌุงุญ",
  "shipment": {
    "id": 1,
    "clearance_per_car": 40.00,
    "internal_transport_total": 1500.00
  }
}
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### **1. ููู HTML ุงูุชูุงุนูู**

```bash
# ุงูุชุญ ูู ุงููุชุตูุญ:
http://your-domain.com/test-company.html
```

**ุงูููุฒุงุช:**
- โ ุญุงุณุจุฉ ุชูุงุนููุฉ
- โ ุชุญุฏูุซ ููุฑู
- โ ูุซุงู ุนููู
- โ ุชูุตูู ูุงูู

### **2. ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช**

```sql
-- ุงุฎุชุจุงุฑ 1: ุงูุชุญูู ูู ุงูุญููู
SELECT 
    COLUMN_NAME,
    COLUMN_TYPE,
    COLUMN_DEFAULT
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'trip_companies'
AND COLUMN_NAME IN ('clearance_per_car', 'internal_transport_total');

-- ุงุฎุชุจุงุฑ 2: ุญุณุงุจ ุดุญูุฉ
SELECT 
    tc.id,
    COUNT(tcr.id) AS cars_count,
    tc.clearance_per_car,
    tc.internal_transport_total,
    (tc.clearance_per_car * COUNT(tcr.id)) AS total_clearance,
    (tc.internal_transport_total / COUNT(tcr.id)) AS transport_per_car
FROM trip_companies tc
LEFT JOIN trip_cars tcr ON tcr.trip_company_id = tc.id
WHERE tc.id = 1
GROUP BY tc.id;
```

### **3. ุงุฎุชุจุงุฑ API**

```bash
# ุงุฎุชุจุงุฑ ุชุญุฏูุซ ุงูุฑุณูู
curl -X PUT http://your-domain.com/api/company-shipments/1/fees \
  -H "Content-Type: application/json" \
  -d '{
    "clearance_per_car": 40,
    "internal_transport_total": 1500
  }'
```

---

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏุงู

### **ุงูุฃููุงู**

```css
ุงูุดุญูุงุช:   #3B82F6 (ุฃุฒุฑู)
ุงูุณูุงุฑุงุช:  #10B981 (ุฃุฎุถุฑ)
ุงูุชุฎููุต:   #8B5CF6 (ุจููุณุฌู)
ุงูููู:     #F59E0B (ุจุฑุชูุงูู)
ุงูุฅุฌูุงูู:  #6366F1 (ุชุฏุฑุฌ ุจููุณุฌู)
```

### **ุงูููููุงุช**

```vue
<!-- ุจุทุงูุฉ ุงูุดุฑูุฉ -->
<CompanyCard>
  - ุงุณู ุงูุดุฑูุฉ
  - ุฑูู ุงููุงุชู
  - ุนุฏุฏ ุงูุดุญูุงุช
  - ุนุฏุฏ ุงูุณูุงุฑุงุช
  - ุงูุฅุฌูุงูู
</CompanyCard>

<!-- ุจุทุงูุฉ ุงูุดุญูุฉ -->
<ShipmentCard>
  - ูุนูููุงุช ุงูุฑุญูุฉ
  - ุนุฏุฏ ุงูุณูุงุฑุงุช
  - ุงูุฑุณูู (ูุงุจูุฉ ููุชุนุฏูู)
  - ูุงุฆูุฉ ุงูุณูุงุฑุงุช (ูุงุจูุฉ ููุชูุณูุน)
</ShipmentCard>

<!-- ุจุทุงูุฉ ุงูุฅุญุตุงุฆูุงุช -->
<StatsCard>
  - ุนุฏุฏ ุงูุดุญูุงุช
  - ุนุฏุฏ ุงูุณูุงุฑุงุช
  - ุฅุฌูุงูู ุงูุชุฎููุต
  - ุฅุฌูุงูู ุงูููู
</StatsCard>
```

---

## โ ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ

### **ุณ1: ููู ุฃุบูุฑ ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ ููุชุฎููุตุ**

```sql
-- ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
ALTER TABLE trip_companies 
MODIFY COLUMN clearance_per_car DECIMAL(10,2) DEFAULT 50.00;

-- ุฃู ูู ุงูููุฏ:
// app/Models/TripCompany.php
protected $attributes = [
    'clearance_per_car' => 50.00,
];
```

### **ุณ2: ูู ูููู ุฃู ูููู ุงูุชุฎููุต ูุฎุชูู ููู ุดุญูุฉุ**

ูุนู! ุงูุชุฎููุต ููุญูุธ ููู ุดุญูุฉ ุจุดูู ูููุตูุ ููููู ุชุนุฏููู ูู ุตูุญุฉ ุงูุชูุงุตูู.

### **ุณ3: ููู ููุญุณุจ ุงูููู ููู ุณูุงุฑุฉุ**

```javascript
ุงูููู ููู ุณูุงุฑุฉ = internal_transport_total รท ุนุฏุฏ ุงูุณูุงุฑุงุช ูู ุงูุดุญูุฉ

ูุซุงู:
1,500 ุฏููุงุฑ รท 50 ุณูุงุฑุฉ = 30 ุฏููุงุฑ/ุณูุงุฑุฉ
```

### **ุณ4: ูุงุฐุง ูู ูุงู ุนุฏุฏ ุงูุณูุงุฑุงุช ุตูุฑุ**

ุงููุธุงู ูุชุญูู ุชููุงุฆูุงู ููุนุฑุถ ุตูุฑ ุจุฏูุงู ูู ุฎุทุฃ ุงููุณูุฉ.

```javascript
transportPerCar = carsCount > 0 ? transportTotal / carsCount : 0;
```

### **ุณ5: ูู ูููู ุชุตุฏูุฑ ุงูุชูุงุฑูุฑุ**

ุญุงููุงู ูุงุ ููู ูููู ุฅุถุงูุฉ ูุฐู ุงูููุฒุฉ ุจุณูููุฉ. ุงุชุตู ุจุงูุฏุนู ุงูููู.

### **ุณ6: ููู ุฃุถูู ุดุฑูุฉ ุฌุฏูุฏุฉุ**

ุงูุดุฑูุงุช ุชูุถุงู ุชููุงุฆูุงู ุนูุฏ ุฅุถุงูุฉ ุดุญูุฉ ููุง ูู ูุธุงู ุงูุฑุญูุงุช.

---

## ๐ ูุซุงู ุนููู ูุงูู

### **ุงูุณููุงุฑูู:**
```
ุงูุดุฑูุฉ: ุงูููู ุงูุณุฑูุน
ุงูุฑุญูุฉ: NOOR 91 - ุฑูู ุงูุฑุญูุฉ: 001
ุชุงุฑูุฎ ุงูุฅุจุญุงุฑ: 2026-01-15
```

### **ุงูุจูุงูุงุช:**
```
ุนุฏุฏ ุงูุณูุงุฑุงุช: 50
ุณุนุฑ ุงูุดุญู: 400 ุฏุฑูู/ุณูุงุฑุฉ
ุณุนุฑ ุงูุตุฑู: 3.6725 ุฏุฑูู/ุฏููุงุฑ
ุงูุชุฎููุต: 40 ุฏููุงุฑ/ุณูุงุฑุฉ
ุงูููู ุงูุฏุงุฎูู: 1,500 ุฏููุงุฑ (ููู)
```

### **ุงูุญุณุงุจุงุช:**

#### **1. ุงูุดุญู:**
```
ุจุงูุฏุฑูู: 400 ร 50 = 20,000 ุฏุฑูู
ุจุงูุฏููุงุฑ: 20,000 รท 3.6725 = 5,447.47 ุฏููุงุฑ
```

#### **2. ุงูุชุฎููุต:**
```
40 ร 50 = 2,000 ุฏููุงุฑ
```

#### **3. ุงูููู:**
```
ุงูููู: 1,500 ุฏููุงุฑ
ููู ุณูุงุฑุฉ: 1,500 รท 50 = 30 ุฏููุงุฑ
```

#### **4. ุงูุฅุฌูุงูู:**
```
5,447.47 + 2,000 + 1,500 = 8,947.47 ุฏููุงุฑ
```

### **ุงููุชูุฌุฉ ูู ุงููุธุงู:**
```
โ ุฅุฌูุงูู ุงูุดุญู: 5,447.47 $
โ ุฅุฌูุงูู ุงูุชุฎููุต: 2,000.00 $
โ ุฅุฌูุงูู ุงูููู: 1,500.00 $
โ ุงูุฅุฌูุงูู ุงูููู: 8,947.47 $
```

---

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### **ุฎุทุฃ 1: ุงูุญููู ุบูุฑ ููุฌูุฏุฉ**

```sql
-- ุงูุญู:
ALTER TABLE trip_companies 
ADD COLUMN clearance_per_car DECIMAL(10,2) DEFAULT 40.00,
ADD COLUMN internal_transport_total DECIMAL(10,2) DEFAULT 0.00;
```

### **ุฎุทุฃ 2: ุงูุตูุญุฉ ูุง ุชุธูุฑ**

```bash
# ุชุญูู ูู ุงูู routes:
php artisan route:list | grep company

# ูุฌุจ ุฃู ุชุฑู:
# GET|HEAD  company-balances
# GET|HEAD  company-balances/{companyId}
```

### **ุฎุทุฃ 3: ุงูุญุณุงุจุงุช ุฎุงุทุฆุฉ**

```javascript
// ุชุญูู ูู:
1. ุณุนุฑ ุงูุตุฑู ูู ุฅุนุฏุงุฏุงุช ุงููุธุงู
2. ุนุฏุฏ ุงูุณูุงุฑุงุช ูู ุงูุดุญูุฉ
3. ุงูููู ุงููุฏุฎูุฉ (ูุง ุชุญุชูู ุนูู null)
```

---

## ๐ ุงูุฏุนู ุงูููู

### **ูููุณุงุนุฏุฉ:**
1. ุฑุงุฌุน ูุฐุง ุงูููู ุฃููุงู
2. ุงูุชุญ `test-company.html` ููุงุฎุชุจุงุฑ
3. ุชุญูู ูู `COMPLETE_SYSTEM_SUMMARY.md`
4. ุฑุงุฌุน ุงูู console ููุฃุฎุทุงุก

### **ุงููููุงุช ุงููููุฉ:**
```
COMPANY_SYSTEM_README.md (ูุฐุง ุงูููู)
COMPLETE_SYSTEM_SUMMARY.md (ุงูููุฎุต ุงููุงูู)
sql_company_clearance_transport.sql (SQL ููุณูุฑูุฑ)
public/test-company.html (ููู ุงูุงุฎุชุจุงุฑ)
```

---

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

โ **ูุธุงู ูุชูุงูู ูุฌุงูุฒ ููุฅูุชุงุฌ!**

- ูุงุฆูุฉ ุงูุดุฑูุงุช โ
- ุชูุงุตูู ุงูุดุฑูุฉ โ
- ูุธุงู ุงูุชุฎููุต โ
- ูุธุงู ุงูููู ุงูุฏุงุฎูู โ
- ุญุณุงุจุงุช ุชููุงุฆูุฉ โ
- ูุงุฌูุฉ ุญุฏูุซุฉ โ
- ุงุฎุชุจุงุฑ ุดุงูู โ
- ุชูุซูู ูุงูู โ

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก**: 2026-01-18  
**ุงูุฅุตุฏุงุฑ**: 2.0.0  
**ุงูุญุงูุฉ**: ๐ข ุฌุงูุฒ ููุฅูุชุงุฌ  
**ุงููุทูุฑ**: AI Assistant  

---

**๐ ูุจุฑูู! ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู!**
