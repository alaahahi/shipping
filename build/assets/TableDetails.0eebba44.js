import{x as T,r as u,m as V,a,g as N,j as L,w as S,F as w,o as s,H as q,b as e,L as A,f as M,t as d,n as Q,i as f,h as C}from"./app.c20c6492.js";import{a as B,_ as O}from"./AuthenticatedLayout.5d660c22.js";import{a as F}from"./index.2a4804ac.js";const H={class:"flex justify-between items-center"},z={class:"flex items-center gap-4"},E={class:"font-semibold text-xl dark:text-gray-200 text-gray-800"},I={class:"flex gap-2"},J=["disabled"],R={key:0},G={key:1},K={class:"py-6"},P={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},U={class:"mb-6 bg-white dark:bg-gray-800 shadow-sm rounded-lg p-6"},W={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},X={class:"text-lg font-semibold dark:text-gray-200"},Y={class:"text-lg font-semibold dark:text-gray-200"},Z={class:"text-lg font-semibold dark:text-gray-200"},ee={class:"text-lg font-semibold dark:text-gray-200"},te={key:0,class:"mb-6 bg-red-50 dark:bg-red-900 border-l-4 border-red-500 p-4 rounded"},ae={class:"text-red-800 dark:text-red-200"},se={key:1,class:"bg-white dark:bg-gray-800 shadow-sm rounded-lg overflow-hidden"},re={key:0,class:"overflow-x-auto"},le={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},oe={class:"bg-gray-50 dark:bg-gray-700 sticky top-0"},de={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},ne={key:0},ie=["colspan"],ce={key:1,class:"p-8 text-center text-gray-500 dark:text-gray-400"},ge={class:"text-xs mt-2"},ue={key:2,class:"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-between items-center border-t border-gray-200 dark:border-gray-600"},ye={class:"text-sm text-gray-700 dark:text-gray-300"},be={class:"flex gap-2"},xe=["disabled"],ve=["disabled"],pe={key:2,class:"bg-white dark:bg-gray-800 shadow-sm rounded-lg p-8 text-center"},me={__name:"TableDetails",props:{tableName:{type:String,required:!0},connection:{type:String,default:"auto"}},setup(c){const k=c,$=T(),y=u([]),_=u([]),b=u(0),x=u(50),g=u(0),n=u(!1),p=u(null),D=l=>l==null?"-":typeof l=="boolean"?l?"\u2713":"\u2717":typeof l=="object"?JSON.stringify(l):typeof l=="string"&&l.length>100?l.substring(0,100)+"...":String(l),h=async(l=0)=>{var t,v;n.value=!0,p.value=null;try{const o={limit:x.value,offset:l};k.connection&&k.connection!=="auto"&&(o.force_connection=k.connection);const r=await F.get(`/api/sync-monitor/table/${k.tableName}`,{params:o,withCredentials:!0});let i=[];Array.isArray(r.data.columns)?i=r.data.columns:r.data.columns&&typeof r.data.columns=="object"&&(i=Object.values(r.data.columns));let m=[];if(Array.isArray(r.data.data)?m=r.data.data:r.data.data&&typeof r.data.data=="object"&&(m=Object.values(r.data.data)),i.length===0&&m.length>0){const j=m[0];j&&typeof j=="object"&&(i=Object.keys(j))}y.value=i,_.value=m,b.value=r.data.total||0,g.value=r.data.offset||l}catch(o){console.error("\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062C\u062F\u0648\u0644:",o),p.value=((v=(t=o.response)==null?void 0:t.data)==null?void 0:v.error)||o.message||"\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A",$.error("\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062C\u062F\u0648\u0644")}finally{n.value=!1}};return V(()=>{h(0)}),(l,t)=>(s(),a(w,null,[N(L(q),{title:`\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062C\u062F\u0648\u0644: ${c.tableName}`},null,8,["title"]),N(O,null,{header:S(()=>[e("div",H,[e("div",z,[N(L(A),{href:"/sync-monitor",class:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 inline-block"},{default:S(()=>[...t[3]||(t[3]=[M(" \u2190 \u0631\u062C\u0648\u0639 ",-1)])]),_:1}),e("h2",E," \u{1F4CB} \u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062C\u062F\u0648\u0644: "+d(c.tableName),1)]),e("div",I,[e("span",{class:Q(["px-3 py-1 rounded-full text-sm font-semibold",c.connection==="sync_sqlite"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100":"bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-100"])},d(c.connection==="sync_sqlite"?"\u{1F5A5}\uFE0F SQLite \u0645\u062D\u0644\u064A":"\u2601\uFE0F MySQL \u0633\u064A\u0631\u0641\u0631"),3),e("button",{onClick:t[0]||(t[0]=v=>h(0)),class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",disabled:n.value},[n.value?(s(),a("span",G,"\u23F3 \u062C\u0627\u0631\u064A...")):(s(),a("span",R,"\u{1F504} \u062A\u062D\u062F\u064A\u062B"))],8,J)])])]),default:S(()=>{var v;return[e("div",K,[e("div",P,[e("div",U,[e("div",W,[e("div",null,[t[4]||(t[4]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"\u0627\u0633\u0645 \u0627\u0644\u062C\u062F\u0648\u0644",-1)),e("p",X,d(c.tableName),1)]),e("div",null,[t[5]||(t[5]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0633\u062C\u0644\u0627\u062A",-1)),e("p",Y,d(((v=b.value)==null?void 0:v.toLocaleString())||0),1)]),e("div",null,[t[6]||(t[6]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"\u0639\u062F\u062F \u0627\u0644\u0623\u0639\u0645\u062F\u0629",-1)),e("p",Z,d(y.value.length),1)]),e("div",null,[t[7]||(t[7]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"\u0627\u0644\u0627\u062A\u0635\u0627\u0644",-1)),e("p",ee,d(c.connection==="sync_sqlite"?"SQLite":"MySQL"),1)])])]),p.value?(s(),a("div",te,[e("p",ae,d(p.value),1)])):f("",!0),!n.value&&!p.value?(s(),a("div",se,[y.value.length>0?(s(),a("div",re,[e("table",le,[e("thead",oe,[e("tr",null,[(s(!0),a(w,null,C(y.value,o=>(s(),a("th",{key:o,class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase border-r border-gray-200 dark:border-gray-600"},d(o),1))),128))])]),e("tbody",de,[_.value.length===0?(s(),a("tr",ne,[e("td",{colspan:y.value.length||1,class:"px-4 py-8 text-center text-gray-500 dark:text-gray-400"}," \u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A ",8,ie)])):f("",!0),(s(!0),a(w,null,C(_.value,(o,r)=>(s(),a("tr",{key:r,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[(s(!0),a(w,null,C(y.value,i=>(s(),a("td",{key:`${r}-${i}`,class:"px-4 py-3 text-sm dark:text-gray-300 border-r border-gray-100 dark:border-gray-700 whitespace-nowrap"},d(D(o[i])),1))),128))]))),128))])])])):(s(),a("div",ce,[t[8]||(t[8]=e("div",{class:"text-5xl mb-2"},"\u{1F4CB}",-1)),t[9]||(t[9]=e("p",null,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0623\u0639\u0645\u062F\u0629 \u0645\u062A\u0627\u062D\u0629 \u0644\u0644\u0639\u0631\u0636",-1)),e("p",ge,"\u0639\u062F\u062F \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A: "+d(_.value.length),1)])),b.value>x.value?(s(),a("div",ue,[e("div",ye," \u0639\u0631\u0636 "+d(g.value+1)+" \u0625\u0644\u0649 "+d(Math.min(g.value+x.value,b.value))+" \u0645\u0646 "+d(b.value),1),e("div",be,[e("button",{onClick:t[1]||(t[1]=o=>h(g.value-x.value)),disabled:g.value===0||n.value,class:"px-4 py-2 border rounded disabled:opacity-50 dark:text-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600"}," \u2190 \u0627\u0644\u0633\u0627\u0628\u0642 ",8,xe),e("button",{onClick:t[2]||(t[2]=o=>h(g.value+x.value)),disabled:g.value+x.value>=b.value||n.value,class:"px-4 py-2 border rounded disabled:opacity-50 dark:text-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600"}," \u0627\u0644\u062A\u0627\u0644\u064A \u2192 ",8,ve)])])):f("",!0)])):f("",!0),n.value?(s(),a("div",pe,[...t[10]||(t[10]=[e("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1),e("p",{class:"mt-4 text-gray-600 dark:text-gray-400"},"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A...",-1)])])):f("",!0)])])]}),_:1})],64))}},he=B(me,[["__scopeId","data-v-efe167cc"]]);export{he as default};
