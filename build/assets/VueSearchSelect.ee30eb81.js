import{O as v,o as m,a as f,b as h,l as d,P as a,t as x,n as p,F as V,h as y,d as I,f as T,K as g}from"./app.8c4ee2e2.js";const n={openOptions(e){e.$refs.input.focus(),e.showMenu=!0,e.mousedownState=!1},blurInput(e){e.mousedownState||(e.searchText="",e.closeOptions()),e.$emit("blur")},closeOptions(e){e.$refs.input.blur(),e.showMenu=!1},prevItem(e){const t=e.pointer-1,o=e.$el.offsetHeight*t;t>=0&&(e.pointer=t),e.$refs.menu.scrollTop=o},nextItem(e){const t=e.pointer+1,o=e.$el.offsetHeight*t;t<=e.filteredOptions.length-1&&(e.pointer=t);const u=e.$refs.menu.offsetHeight,l=Math.ceil((e.$refs.menu.scrollTop+e.$el.offsetHeight)/u),s=Math.ceil(o/u);l!==s&&(e.$refs.menu.scrollTop=(s-1)*e.$refs.menu.offsetHeight)},enterItem(e){const t=e.filteredOptions[e.pointer],o=t.disabled;t&&!o&&e.selectItem(t)},pointerSet(e,t){e.pointer=t},pointerAdjust(e){e.pointer>=e.filteredOptions.length-1&&(e.pointer=e.filteredOptions.length?e.filteredOptions.length-1:0)},mousedownItem(e){e.mousedownState=!0}};function w(e){return new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i")}const O={props:{id:{default:null},name:{type:String,default:""},isError:{type:Boolean,default:!1},customAttr:{type:Function,default:()=>""},isDisabled:{type:Boolean,default:!1},placeholder:{type:String,default:""},filterPredicate:{type:Function,default:(e,t)=>e.match(w(t))}}},S=(e,t)=>{const o=e.__vccOpts||e;for(const[u,l]of t)o[u]=l;return o},$={name:"ModelSelect",mixins:[O],emits:["blur","searchchange","update:modelValue"],props:{modelValue:{type:[String,Number,Object,Boolean]},customAttr:{type:Function,default:()=>""},options:{type:Array}},data(){return{showMenu:!1,searchText:"",mousedownState:!1,pointer:-1}},watch:{value(e){this.pointer=this.filteredOptions.findIndex(t=>t.value===this.optionValue(e))},filteredOptions(){this.pointerAdjust()},searchText(){this.$emit("searchchange",this.searchText)}},computed:{searchTextCustomAttr(){return this.selectedOption&&this.selectedOption.value?this.customAttr(this.selectedOption):""},inputText(){if(this.searchText)return"";{let e=this.placeholder;return this.selectedOption&&(e=this.selectedOption.text),e}},customAttrs(){try{if(Array.isArray(this.options))return this.options.map(e=>this.customAttr(e))}catch{}return[]},textClass(){return!this.selectedOption&&this.placeholder?"default":""},menuClass(){return{visible:this.showMenu,hidden:!this.showMenu}},menuStyle(){return{display:this.showMenu?"block":"none"}},filteredOptions(){return this.searchText?this.options.filter(e=>{try{return this.filterPredicate(e.text,this.searchText)}catch{return!0}}):this.options},selectedOption(){return this.options.find(e=>e.value===this.optionValue(this.modelValue))}},methods:{deleteTextOrItem(){!this.searchText&&this.modelValue&&(this.selectItem({}),this.openOptions())},openOptions(){n.openOptions(this)},blurInput(){n.blurInput(this)},closeOptions(){n.closeOptions(this)},prevItem(){n.prevItem(this)},nextItem(){n.nextItem(this)},enterItem(){n.enterItem(this)},pointerSet(e){n.pointerSet(this,e)},pointerAdjust(){n.pointerAdjust(this)},mousedownItem(){n.mousedownItem(this)},selectItem(e){this.searchText="",this.closeOptions(),typeof this.modelValue=="object"&&this.modelValue?this.$emit("update:modelValue",e):(this.$emit("update:modelValue",e.value),e.value!==void 0&&e.value===e.text&&(this.searchText=e.value))},optionValue(e){return typeof e=="object"&&e!==null?e.value:e}}},A=h("i",{class:"dropdown icon"},null,-1),M=["disabled","tabindex","id","name","value"],j=["data-vss-custom-attr"],D=["data-vss-custom-attr","onClick","onMouseenter"];function B(e,t,o,u,l,s){return m(),f("div",{class:p(["ui fluid search selection dropdown",{"active visible":l.showMenu,error:e.isError,disabled:e.isDisabled}]),onClick:t[11]||(t[11]=(...i)=>s.openOptions&&s.openOptions(...i)),onFocus:t[12]||(t[12]=(...i)=>s.openOptions&&s.openOptions(...i))},[A,h("input",{class:"search",autocomplete:"off",disabled:e.isDisabled,tabindex:e.isDisabled?-1:0,id:e.id,name:e.name,value:l.searchText,onInput:t[0]||(t[0]=i=>l.searchText=i.target.value),ref:"input",onFocus:t[1]||(t[1]=d((...i)=>s.openOptions&&s.openOptions(...i),["prevent"])),onKeyup:[t[2]||(t[2]=a((...i)=>s.closeOptions&&s.closeOptions(...i),["esc"])),t[7]||(t[7]=a(d((...i)=>s.enterItem&&s.enterItem(...i),["prevent"]),["enter"]))],onBlur:t[3]||(t[3]=(...i)=>s.blurInput&&s.blurInput(...i)),onKeydown:[t[4]||(t[4]=a((...i)=>s.prevItem&&s.prevItem(...i),["up"])),t[5]||(t[5]=a((...i)=>s.nextItem&&s.nextItem(...i),["down"])),t[6]||(t[6]=a(d(()=>{},["prevent"]),["enter"])),t[8]||(t[8]=a((...i)=>s.deleteTextOrItem&&s.deleteTextOrItem(...i),["delete"]))]},null,40,M),h("div",{class:p(["text",s.textClass]),"data-vss-custom-attr":s.searchTextCustomAttr},x(s.inputText),11,j),h("div",{class:p(["menu",s.menuClass]),ref:"menu",onMousedown:t[10]||(t[10]=d(()=>{},["prevent"])),style:g(s.menuStyle),tabindex:"-1"},[(m(!0),f(V,null,y(s.filteredOptions,(i,r)=>(m(),f("div",{key:r,class:p(["item",{selected:i.selected||l.pointer===r,disabled:i.disabled}]),"data-vss-custom-attr":s.customAttrs[r]?s.customAttrs[r]:"",onClick:d(c=>s.selectItem(i),["stop"]),onMousedown:t[9]||(t[9]=(...c)=>s.mousedownItem&&s.mousedownItem(...c)),onMouseenter:c=>s.pointerSet(r)},[I(e.$slots,"default",{option:i,idx:r},()=>[T(x(i.text),1)])],42,D))),128))],38)],34)}const b=S($,[["render",B]]),k={name:"ModelListSelect",mixins:[O],emits:["blur","searchchange","update:modelValue"],render:function(){return v(b,{id:this.id,name:this.name,options:this.options,modelValue:this.innerValue,isError:this.isError,isDisabled:this.isDisabled,placeholder:this.placeholder,filterPredicate:this.filterPredicate,onBlur:()=>this.$emit("blur"),"onUpdate:modelValue":this.onInput,onSearchchange:e=>this.$emit("searchchange",e)})},props:{modelValue:{type:[String,Number,Object,Boolean]},list:{type:Array},optionValue:{type:String},optionText:{type:String},customText:{type:Function},optionDisabled:{type:String}},computed:{options(){return this.list.map(e=>({value:e[this.optionValue],text:this.buildText(e),disabled:!!e[this.optionDisabled]}))},innerValue(){return this.modelValue?typeof this.modelValue=="object"?this.modelValue?{value:this.modelValue[this.optionValue],text:this.buildText(this.modelValue),disabled:!!this.modelValue[this.optionDisabled]}:{value:"",text:"",disabled:!1}:this.modelValue:this.modelValue}},methods:{buildText(e){return e[this.optionValue]!==void 0?this.customText?this.customText(e):e[this.optionText]:""},onInput(e){if(e===void 0)return this.$emit("update:modelValue","");if(Object.keys(e).length===0&&e.constructor===Object)this.$emit("update:modelValue",e);else if(typeof e=="object"){const t=this.list.find(o=>o[this.optionValue]===e.value);this.$emit("update:modelValue",t)}else this.$emit("update:modelValue",e)}},components:{ModelSelect:b}};export{k as q};
